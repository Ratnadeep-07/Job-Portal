package master.dao;

import java.sql.*;
import master.dto.JobSeekerDto;
import master.utility.DBConnection;

public class JobSeekerDao {
    
    // Specifying columns explicitly is best practice
    private final String INSERT_SQL = "INSERT INTO jobseeker (username, password, name, phone, email, domain, yexp) VALUES(?,?,?,?,?,?,?)";

    public boolean addSeeker(JobSeekerDto j) {
        Connection con = null;
        PreparedStatement ps = null;
        boolean isSuccess = false;

        try {
            con = DBConnection.getConnection();
            ps = con.prepareStatement(INSERT_SQL);
            
            ps.setString(1, j.getUsername());
            ps.setString(2, j.getPassword());
            ps.setString(3, j.getName());
            ps.setString(4, j.getPhone());
            ps.setString(5, j.getEmail());
            ps.setString(6, j.getDomain());
            ps.setString(7, j.getYexp());

            int rowsAffected = ps.executeUpdate();
            if (rowsAffected > 0) {
                isSuccess = true;
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // FIXED: Closing resources in the finally block ensures they close even if an error occurs
            try {
                if (ps != null) ps.close();
                if (con != null) con.close();
            } catch (SQLException se) {
                se.printStackTrace();
            }
        }
        return isSuccess; // FIXED: Now returns the actual result
    }
}
